theil[["forecast"]]["Monetario"], bias[["forecast"]]["Monetario"],
log.lik[["forecast"]]["Monetario"], c.i[["forecast"]]["Monetario"],
r.2[["forecast"]]["Monetario"], trend[["forecast"]]["Monetario"])
colnames(forecast.monetario) <- crit.stat
forecast.demanda <- cbind(mape[["forecast"]]["Demanda"], mse[["forecast"]]["Demanda"],
theil[["forecast"]]["Demanda"], bias[["forecast"]]["Demanda"],
log.lik[["forecast"]]["Demanda"], c.i[["forecast"]]["Demanda"],
r.2[["forecast"]]["Demanda"], trend[["forecast"]]["Demanda"])
colnames(forecast.demanda) <- crit.stat
fore.costos    <- rowMeans(forecast.costos)
fore.monetario <- rowMeans(forecast.monetario)
fore.demanda   <- rowMeans(forecast.demanda)
linf <- rowMeans(cbind(mape[["forecast"]]["lower"], mse[["forecast"]]["lower"],
theil[["forecast"]]["lower"], bias[["forecast"]]["lower"],
log.lik[["forecast"]]["lower"], c.i[["forecast"]]["lower"],
r.2[["forecast"]]["lower"], trend[["forecast"]]["lower"]))
lsup <- rowMeans(cbind(mape[["forecast"]]["upper"], mse[["forecast"]]["upper"],
theil[["forecast"]]["upper"], bias[["forecast"]]["upper"],
log.lik[["forecast"]]["upper"], c.i[["forecast"]]["upper"],
r.2[["forecast"]]["upper"], trend[["forecast"]]["upper"]))
forecast.mean <- cbind(rowMeans(forecast.price), linf, lsup, lsup -
rowMeans(forecast.price))
forecast.mean <- as.data.frame(forecast.mean)
colnames(forecast.mean) <- c("Forecast", "linf", "lsup", "CI")
}
#creacion de las graficas
library(lubridate)
#creacion de las graficas
mat.plot <- cbind(c(vec$y[1:n,region], rep(NA, length.fore)), c(rep(NA, n - 1),
vec$y[n], forecast.mean[,"Forecast"]),
c(rep(NA, n), linf), c(rep(NA, n), lsup))
mat.plot <- as.data.frame(mat.plot)
colnames(mat.plot) <- c(region, "Pronostico", "Limite Inferior", "Limite Superior")
mat.plot.exog <- scale(cbind(c(endog.mat[,"Costos"], fore.costos), c(endog.mat[,"Monetario"], fore.monetario),
c(endog.mat[,"Demanda"], fore.demanda)))
mat.plot.exog <- as.data.frame(mat.plot.exog)
colnames(mat.plot.exog) <- c("Costos", "Monetario", "Demanda")
mat.graph <- as.data.frame(vec$y)
seq.graph <- c(nrow(mat.graph) - show.data - length.fore  + 1): nrow(mat.graph)
mat.plot <- mat.plot[seq.graph,]
#####
name.mes <- substring(as.character(seq(as.Date("2005/01/01"),
by = "month", length = nrow(mat.graph))), 3, 7)
name.mes  <- name.mes[seq.graph]
temp <- as.data.frame(mat.plot)
temp$tiempo <- ymd(paste0('20',name.mes,'-01'))
temp$color <- 'indianred4'
temp$color[temp$tiempo<= (max(temp$tiempo) - months(length.fore+10))] <- 'indianred4'
extra <- as.data.frame(precios.row[, region])
names(extra) <- 'value'
extra$tiempo <- ymd(row.names(precios.row))
temp2 <- temp[,c('Limite Inferior', 'Limite Superior', "color", 'tiempo') ]
temp2$color <- 'khaki4'
temp <- temp[,c(region, "Pronostico" , "color", 'tiempo') ]
temp <- melt(temp, id=c('color', 'tiempo'))
temp2 <- melt(temp2, id=c('color', 'tiempo'))
index <- which(as.character(temp2$variable)=='Limite Inferior')
temp2.1 <- temp2[index, ]
names(temp2.1) <- c('color', 'tiempo', 'variable', 'value.inf' )
temp2.2 <- temp2[-index,]
temp2 <- cbind(temp2.1, temp2.2$value)
names(temp2) <- c(names(temp2)[1:4], 'value')
seq.forecast <- c(nrow(mat.plot) - length.fore + 1) : nrow(mat.plot)
media <- mean(c(mat.plot[,region],mat.plot[seq.forecast, "Pronostico"]), na.rm = TRUE)
sdd <-  sd(c(mat.plot[,region],mat.plot[seq.forecast, "Pronostico"]), na.rm = TRUE)
sectores <- data.frame(Costos=mat.plot.exog[, "Costos"]*sdd + media,
Monetario=mat.plot.exog[, "Monetario"]*sdd + media,
Demanda=mat.plot.exog[, "Demanda"]*sdd + media)
sectores$tiempo <- mes.first + months(0:(nrow(sectores)-1))
sectores <- melt(sectores, id='tiempo')
# construccion d ela grafica
p.hist <- ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.3))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.3)) +
geom_ribbon(data=temp2, aes(ymin=value.inf, ymax=value, fill='IC 95%'),
alpha=0.3,show.legend =FALSE)+
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))+
#scale_x_date(date_labels = '%y/%m', breaks = extra$tiempo)+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE)+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
#legend.position="bottom",
legend.title = element_blank())+
#xlim(c(mes.first+years(5), max(temp$tiempo))) +
ylab('') + xlab('Fecha') + ylim(range(extra$value))
p.hist
# construccion d ela grafica
p.hist <- ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.3))+
geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.3)) +
#geom_ribbon(data=temp2, aes(ymin=value.inf, ymax=value, fill='IC 95%'),
#           alpha=0.3,show.legend =FALSE)+
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE)+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())+
ylab('') + xlab('Fecha') + ylim(range(extra$value))
p.hist
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.3))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.3))+
geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.3))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1))
View(temp2.1)
View(temp2)
View(temp2)
# construccion d ela grafica
p.hist <- ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'),
alpha=0.3,show.legend =FALSE)+
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE)+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())+
ylab('') + xlab('Fecha') + ylim(range(extra$value))
p.hist
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'),
alpha=0.3,show.legend =FALSE)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'), lty=2)+
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'), lty=2)
# construccion d ela grafica
p.hist <- ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'), lty=2)+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%'), lty=2)
p.hist
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%'))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%'))
scale_fill_discrete(guide=FALSE)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%'))
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%'))
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%')) +
scale_fill_discrete(guide=FALSE)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, fill='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, fill='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))
# construccion d ela grafica
p.hist <- ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple' ),
labels=c(  'Historico' ,  'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE)+
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())+
ylab('') + xlab('Fecha') + ylim(range(extra$value))
p.hist
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%'))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple', 'orenge' ),
labels=c(  'Historico' ,  'Pronostico', 'I.C. 95%' ))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",  'purple', 'orange' ),
labels=c(  'Historico' ,  'Pronostico', 'I.C. 95%' ))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo))))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE, color=FALSE)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE)
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE, color='')
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE) + labs(color= "")
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE) + labs(color= "") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE) + labs(color= "") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())+
ylab('') + xlab('Fecha') + ylim(range(extra$value))
# construccion d ela grafica
p.hist <- ggplot(data=extra,  aes(x=tiempo, y=value, color='Historico'  ))+
geom_line(size=1.5)+
geom_line(data=subset(temp, as.character(variable)!=region),
aes(x=tiempo, y=value, color='Pronostico'), lty=2, size=1.5)+
#geom_line(data=temp2.1, aes(x=tiempo, y=value.inf, color='Lim. inf 95%', size=0.1))+
#geom_line(data=temp2.2, aes(x=tiempo, y=value, color= 'Lim. sup 95%', size=0.1)) +
geom_line(data=temp2, aes(x = tiempo, y=value.inf, color='IC 95%'))+
geom_line(data=temp2, aes(x = tiempo, y=value, color='IC 95%')) +
scale_fill_discrete(guide=FALSE)+
scale_color_manual(
values=c(   "lightblue",   'orange', 'purple' ),
labels=c(  'Historico' , 'I.C. 95%', 'Pronostico' ))+
xlim(c(ymd('2005-01-01'), max(c(extra$tiempo, temp$tiempo, temp2$tiempo))))+
theme_minimal()+
guides( size = FALSE, fill=FALSE, alpha=FALSE) + labs(color= "") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())+
ylab('') + xlab('Fecha') + ylim(range(extra$value))
p.hist
dir.create(paste0(dt.file, "BinariosMax/"))
setwd(paste0(dt.file,'BinariosMax/' ))
save(p.hist, file=paste0( 'GGplotpronostico_fecha_corteMes_ ',
month(mes.last ), ' anio_', year(mes.last ),
'numero_de_meses_pronostico_', length.fore, " region ", region,  '.Rdata' ))
p.hist <- ggplotly(p.hist, tooltip = c('x','y'), dynamicTicks = TRUE )
p.hist <- p.hist %>% config(collaborate=FALSE , displaylogo = FALSE) %>%
layout(legend = list(orientation = 'h'))
p.hist
